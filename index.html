<!Doctype HTML>
<html>

<head>
	<title> 3300 P1</title>
	<meta charset="UTF-8">
	<style>
  svg { background-color: #f5f5dc; }
  </style>
	<script src="https://d3js.org/d3.v4.min.js"></script>
</head>

<body>
	<p> Visualize Data Here </p>
	<div id="container">
		<svg height="800" width="700" id="svg"></svg>
	</div>
	<script>

		// snag the svg element from outside the script tag
		var svg = d3.select("#svg");

		// get the height/width of the svg element as variables
		var width = document.getElementsByTagName("svg")[0].getAttribute("width");
		var height = document.getElementsByTagName("svg")[0].getAttribute("height");

		// json obj to hold all of the read-in files
		var totalMedals = new Object();

		// read in the summerMedalData csv file
		d3.csv("summerMedalData.csv", function(data) {
			data.forEach(function(d) {
				totalMedals[d.country] = {
					count: Number(d["count(*)"])
				};
			});
		});

		// read in the winterMedalData csv file and add to summer
		d3.csv("winterMedalData.csv", function(data) {
			data.forEach(function(d) {
				if (totalMedals[d.country] != undefined) {
					totalMedals[d.country].count += Number(d["count(*)"])
				}
			});

			console.log(totalMedals);

			// here, subarr is an intermediary array to hold medal counts, which will be then be sorted
			subarr = []
			for (key in totalMedals) {
				subarr.push(totalMedals[key].count)
			}

			// sort the medal counts and then extract top 10
			subarr.sort(function(a,b) {
				return b - a
			});

			// top ten medal counts with their respective country
			var tenCounts = subarr.slice(0, 10)
			var tenCountries = []

			tenCounts.forEach(function(x) {
				for (key in totalMedals) {
					if(totalMedals[key].count == x) {
						tenCountries.push(key)
					}
				}
			})

			console.log(tenCounts);
			console.log(tenCountries);

			var pedScale = d3.scaleLinear()
              .domain([tenCounts[9], tenCounts[0]])
              .range([100, 400]);

			console.log(pedScale(tenCounts[0]))

			// 1st, place
			svg.append("rect")
			.attr("y", 150)
			.attr("x", width/2 - 98/2)
			.attr("height", pedScale(tenCounts[0]))
			.attr("width", 98)
			.style("fill", "#FFD700");
			svg.append("image")
			.attr("xlink:href", "flag1.png")
			.attr("x", width/2 - 74/2)
			.attr("y", height/2 - 320)
			.attr("width", 74);
			svg.append("text")
			.attr("x", width/2 - 20)
			.attr("y", height/2 - 200)
			.attr("font-family", "Arial")
			.attr("font-size", 25)
			.attr("fill", "#F09F12")
			.text(tenCounts[0]);

			// 2nd place
			svg.append("rect")
			.attr("y", 150 + (400 - pedScale(tenCounts[1])))
			.attr("x", width/2 + 50)
			.attr("height", pedScale(tenCounts[1]))
			.attr("width", 98)
			.style("fill", "#FFD700");
			svg.append("image")
			.attr("xlink:href", "flag2.png")
			.attr("x", width/2 + 62)
			.attr("y", height/2 - 180)
			.attr("width", 74);
			svg.append("text")
			.attr("x", width/2 + 79)
			.attr("y", height/2 - 52)
			.attr("font-family", "Arial")
			.attr("font-size", 25)
			.attr("fill", "#F09F12")
			.text(tenCounts[1]);

			// 3rd place
			svg.append("rect")
			.attr("y", 150 + (400 - pedScale(tenCounts[2])))
			.attr("x", width/2 - 98*1.5 - 1)
			.attr("height", pedScale(tenCounts[2]))
			.attr("width", 98)
			.style("fill", "#FFD700");
			svg.append("image")
			.attr("xlink:href", "flag3.png")
			.attr("x", width/2 - 98*1.5 + 9)
			.attr("y", height/2 - 175)
			.attr("width", 74);
			svg.append("text")
			.attr("x", width/2 - 98*1.5 + 25)
			.attr("y", height/2 - 45)
			.attr("font-family", "Arial")
			.attr("font-size", 25)
			.attr("fill", "#F09F12")
			.text(tenCounts[2]);

			// 4th place
			svg.append("rect")
			.attr("y", 550 + 1)
			.attr("x", width/2 - 98*1.5 - 1)
			.attr("height", pedScale(tenCounts[3]))
			.attr("width", 290/7)
			.style("fill", "#FFD700");
			svg.append("image")
			.attr("xlink:href", "flag4.png")
			.attr("x", width/2 - 98*1.5 + 4)
			.attr("y", height/2 + 370)
			.attr("width", 290/7 - 10);
			svg.append("text")
			.attr("x", width/2 - 98*1.5 + 6)
			.attr("y", height/2 + 350)
			.attr("font-family", "Arial")
			.attr("font-size", 15)
			.attr("fill", "#F09F12")
			.text(tenCounts[3]);

			// 5th place
			svg.append("rect")
			.attr("y", 550 + 1)
			.attr("x", width/2 - 147 + 290/7)
			.attr("height", pedScale(tenCounts[4]))
			.attr("width", 290/7)
			.style("fill", "#FFD700");
			svg.append("image")
			.attr("xlink:href", "flag5.png")
			.attr("x", width/2 - 147 + 290/7 + 5)
			.attr("y", height/2 + 300)
			.attr("width", 290/7 - 10);
			svg.append("text")
			.attr("x", width/2 - 147 + 290/7 + 8)
			.attr("y", height/2 + 280)
			.attr("font-family", "Arial")
			.attr("font-size", 15)
			.attr("fill", "#F09F12")
			.text(tenCounts[4]);

			// 5th place
			svg.append("rect")
			.attr("y", 550 + 1)
			.attr("x", width/2 - 146 + (290/7)*2)
			.attr("height", pedScale(tenCounts[5]))
			.attr("width", 290/7)
			.style("fill", "#FFD700");
			svg.append("image")
			.attr("xlink:href", "flag6.png")
			.attr("x", width/2 - 146 + (290/7)*2 + 5)
			.attr("y", height/2 + 288)
			.attr("width", 290/7 - 10);
			svg.append("text")
			.attr("x", width/2 - 146 + (290/7)*2 + 9)
			.attr("y", height/2 + 267)
			.attr("font-family", "Arial")
			.attr("font-size", 15)
			.attr("fill", "#F09F12")
			.text(tenCounts[5]);

			// 6th place
			svg.append("rect")
			.attr("y", 550 + 1)
			.attr("x", width/2 - 145 + (290/7)*3)
			.attr("height", pedScale(tenCounts[6]))
			.attr("width", 290/7)
			.style("fill", "#FFD700");
			svg.append("image")
			.attr("xlink:href", "flag7.jpg")
			.attr("x", width/2 - 146 + (290/7)*3 + 7)
			.attr("y", height/2 + 285)
			.attr("width", 290/7 - 10);
			svg.append("text")
			.attr("x", width/2 - 146 + (290/7)*3 + 10)
			.attr("y", height/2 + 265)
			.attr("font-family", "Arial")
			.attr("font-size", 15)
			.attr("fill", "#F09F12")
			.text(tenCounts[6]);

			// 7th place
			svg.append("rect")
			.attr("y", 550 + 1)
			.attr("x", width/2 - 144 + (290/7)*4)
			.attr("height", pedScale(tenCounts[7]))
			.attr("width", 290/7)
			.style("fill", "#FFD700");
			svg.append("image")
			.attr("xlink:href", "flag8.png")
			.attr("x", width/2 - 146 + (290/7)*4 + 7)
			.attr("y", height/2 + 267)
			.attr("width", 290/7 - 10);
			svg.append("text")
			.attr("x", width/2 - 146 + (290/7)*4 + 11)
			.attr("y", height/2 + 248)
			.attr("font-family", "Arial")
			.attr("font-size", 15)
			.attr("fill", "#F09F12")
			.text(tenCounts[7]);

			// 8th place
			svg.append("rect")
			.attr("y", 550 + 1)
			.attr("x", width/2 - 143 + (290/7)*5)
			.attr("height", pedScale(tenCounts[8]))
			.attr("width", 290/7)
			.style("fill", "#FFD700");
			svg.append("image")
			.attr("xlink:href", "flag9.png")
			.attr("x", width/2 - 146 + (290/7)*5 + 8)
			.attr("y", height/2 + 265)
			.attr("width", 290/7 - 10);
			svg.append("text")
			.attr("x", width/2 - 146 + (290/7)*5 + 12)
			.attr("y", height/2 + 246)
			.attr("font-family", "Arial")
			.attr("font-size", 15)
			.attr("fill", "#F09F12")
			.text(tenCounts[8]);

			// 9th place
			svg.append("rect")
			.attr("y", 550 + 1)
			.attr("x", width/2 - 142 + (290/7)*6)
			.attr("height", pedScale(tenCounts[9]))
			.attr("width", 290/7)
			.style("fill", "#FFD700");
			svg.append("image")
			.attr("xlink:href", "flag10.png")
			.attr("x", width/2 - 146 + (290/7)*6 + 9)
			.attr("y", height/2 + 262)
			.attr("width", 290/7 - 10);
			svg.append("text")
			.attr("x", width/2 - 146 + (290/7)*6 + 13)
			.attr("y", height/2 + 244)
			.attr("font-family", "Arial")
			.attr("font-size", 15)
			.attr("fill", "#F09F12")
			.text(tenCounts[9]);

		}); // end of callback

	</script>
    <br>
    <a href="GDPVis.html"> GDP vs Medals Earned Visualization </a>
</body>



</html>
