<!Doctype HTML>
<html>

<head>
    <title> 3300 P1</title>
    <meta charset="UTF-8">
    <style>
    svg { background-color: rgba(245,245,220, 0.9); display:block; margin:auto; font-family:Georgia; }
    .title {text-align:center; font-size:100px; color:#FFD700; width:50%;display:block; margin:auto; margin-bottom:10px;}
</style>
<script src="https://d3js.org/d3.v4.min.js"></script>
</head>

<!-- Background Image Courtesy of : https://www.elegantthemes.com/blog/freebie-of-the-week/20-free-background-images-for-wordpress
-->
<!-- https://www.crafthubs.com/olympic-patterns/12831 -->
<body style="background-color:beige" width="100%">
    <p class="title"> What Makes A Country An Olympic Champion? </p>
    <div id="container">
        <svg height="1000" width="1000" id="svg"></svg>
    </div>
    <script>

        var GDPVis; //To be called after the second SVG element to ensure render ordering

        // snag the svg element from outside the script tag
        var svg = d3.select("#svg");

        // get the height/width of the svg element as variables
        var width = document.getElementsByTagName("svg")[0].getAttribute("width");
        var height = document.getElementsByTagName("svg")[0].getAttribute("height");

        // json obj to hold all of the read-in files
        var totalMedals = new Object();

        // read in the summerMedalData csv file
        d3.csv("summerMedalData.csv", function(data) {
            data.forEach(function(d) {
                totalMedals[d.country] = {
                    count: Number(d["count(*)"])
                };
            });
        });

        // read in the winterMedalData csv file and add to summer
        d3.csv("winterMedalData.csv", function(data) {
            data.forEach(function(d) {
                if (totalMedals[d.country] != undefined) {
                    totalMedals[d.country].count += Number(d["count(*)"])
                }
            });


            // here, subarr is an intermediary array to hold medal counts, which will be then be sorted
            subarr = []
            for (key in totalMedals) {
                subarr.push(totalMedals[key].count)
            }

            // sort the medal counts and then extract top 10
            subarr.sort(function(a,b) {
                return b - a
            });

            // top ten medal counts with their respective country
            var tenCounts = subarr.slice(0, 10)
            var tenCountries = []

            tenCounts.forEach(function(x) {
                for (key in totalMedals) {
                    if(totalMedals[key].count == x) {
                        tenCountries.push(key)
                    }
                }
            })

            // height of each bar scale
            var pedScale = d3.scaleLinear()
            .domain([tenCounts[9], tenCounts[0]])
            .range([100, 400]);

            // x-dist of top three
            var topThreeScale = d3.scaleLinear()
            .domain([1, 3])
            .range([width/3 - 13, width/3 + 250])

            // x-dist of bottom seven
            var bottomSevenScale = d3.scaleLinear()
            .domain([4,10])
            .range([width/3 - 13, width/3 + 320])

            var top = height - (height-300)

            // Title
            svg.append("text")
            .attr("x", width/2)
            .attr("y", height - (height-50))
            .attr("font-size", 36)
            .attr("fill", "black")
            .attr("text-anchor", "middle")
            .text("Highest Medal-Earning Countries");
            svg.append("text")
            .attr("x", width/2)
            .attr("y", height - (height-90))
            .attr("font-size", 36)
            .attr("fill", "black")
            .attr("text-anchor", "middle")
            .text("Across Winter and Summer Olympics");
            svg.append("text")
            .attr("x", width/2)
            .attr("y", height - (height-130))
            .attr("font-size", 36)
            .attr("fill", "black")
            .attr("text-anchor", "middle")
            .text("(1985 - 2012)");

            // Logo
            svg.append("image")
            .attr("xlink:href", "olympic-logo.png")
            .attr("x", topThreeScale(1) - 320)
            .attr("y", top)
            .attr("height", 500)
            .attr("width", 1000)
            .attr("opacity", "0.35");

            // 1st place
            svg.append("rect")
            .attr("x", topThreeScale(2))
            .attr("y", top)
            .attr("height", pedScale(tenCounts[0]))
            .attr("width", 120)
            .style("fill", "#FFD700");
            svg.append("image")
            .attr("xlink:href", "img/flag1.png")
            .attr("x", topThreeScale(2) + 10)
            .attr("y", top-100)
            .attr("width", 100)
            .attr("height", 80);
            svg.append("text")
            .attr("x", topThreeScale(2) + 25)
            .attr("y", top + 45)
            .attr("font-family", "Arial")
            .attr("font-size", 40)
            .attr("fill", "white")
            .text(tenCounts[0]);

            // 2nd place
            svg.append("rect")
            .attr("y", top + (pedScale(tenCounts[0]) - pedScale(tenCounts[1])))
            .attr("x", topThreeScale(1))
            .attr("height", pedScale(tenCounts[1]))
            .attr("width", 120)
            .style("fill", "#8B8878");
            svg.append("image")
            .attr("xlink:href", "img/flag2.png")
            .attr("x", topThreeScale(1) + 10)
            .attr("y", top + (pedScale(tenCounts[0]) - pedScale(tenCounts[1])) - 100)
            .attr("width", 100)
            .attr("height", 80);
            svg.append("text")
            .attr("x", topThreeScale(1) + 25)
            .attr("y", top + (pedScale(tenCounts[0]) - pedScale(tenCounts[1])) + 45)
            .attr("font-family", "Arial")
            .attr("font-size", 40)
            .attr("fill", "white")
            .text(tenCounts[1]);

            // 3rd place
            svg.append("rect")
            .attr("y", top + (pedScale(tenCounts[0]) - pedScale(tenCounts[2])))
            .attr("x", topThreeScale(3))
            .attr("height", pedScale(tenCounts[2]))
            .attr("width", 120)
            .style("fill", "#A67D3D");
            svg.append("image")
            .attr("xlink:href", "img/flag3.png")
            .attr("x", topThreeScale(3) + 10)
            .attr("y", top + (pedScale(tenCounts[0]) - pedScale(tenCounts[2])) - 100)
            .attr("width", 100)
            .attr("height", 80);
            svg.append("text")
            .attr("x", topThreeScale(3) + 25)
            .attr("y", top + (pedScale(tenCounts[0]) - pedScale(tenCounts[2])) + 40)
            .attr("font-family", "Arial")
            .attr("font-size", 40)
            .attr("fill", "white")
            .text(tenCounts[2]);

            var bottomTop = top+pedScale(tenCounts[0])+5

            // 4th place
            svg.append("rect")
            .attr("y", bottomTop)
            .attr("x", bottomSevenScale(4))
            .attr("height", pedScale(tenCounts[3]))
            .attr("width", 49)
            .style("fill", "#8C7853");
            svg.append("image")
            .attr("xlink:href", "img/flag4.png")
            .attr("x", bottomSevenScale(4) + 5)
            .attr("y", bottomTop + pedScale(tenCounts[3]) + 10)
            .attr("width", 40)
            .attr("height", 30);
            svg.append("text")
            .attr("x", bottomSevenScale(4) + 8)
            .attr("y", bottomTop + pedScale(tenCounts[3]) - 10)
            .attr("font-family", "Arial")
            .attr("font-size", 18)
            .attr("fill", "white")
            .text(tenCounts[3]);

            // 5th place
            svg.append("rect")
            .attr("y", bottomTop)
            .attr("x", bottomSevenScale(5))
            .attr("height", pedScale(tenCounts[4]))
            .attr("width", 49)
            .style("fill", "#8C7853");
            svg.append("image")
            .attr("xlink:href", "img/flag5.png")
            .attr("x", bottomSevenScale(5) + 5)
            .attr("y", bottomTop + pedScale(tenCounts[4]) + 10)
            .attr("width", 40)
            .attr("height", 30);
            svg.append("text")
            .attr("x", bottomSevenScale(5) + 9)
            .attr("y", bottomTop + pedScale(tenCounts[4]) - 10)
            .attr("font-family", "Arial")
            .attr("font-size", 18)
            .attr("fill", "white")
            .text(tenCounts[4]);

            // 6th place
            svg.append("rect")
            .attr("y", bottomTop)
            .attr("x", bottomSevenScale(6))
            .attr("height", pedScale(tenCounts[5]))
            .attr("width", 49)
            .style("fill", "#8C7853");
            svg.append("image")
            .attr("xlink:href", "img/flag6.png")
            .attr("x", bottomSevenScale(6) + 5)
            .attr("y", bottomTop + pedScale(tenCounts[5]) + 10)
            .attr("width", 40)
            .attr("height", 30);
            svg.append("text")
            .attr("x", bottomSevenScale(6) + 10)
            .attr("y", bottomTop +  pedScale(tenCounts[5]) - 10)
            .attr("font-family", "Arial")
            .attr("font-size", 18)
            .attr("fill", "white")
            .text(tenCounts[5]);

            // 7th place
            svg.append("rect")
            .attr("y", bottomTop)
            .attr("x", bottomSevenScale(7))
            .attr("height", pedScale(tenCounts[6]))
            .attr("width", 49)
            .style("fill", "#8C7853");
            svg.append("image")
            .attr("xlink:href", "img/flag7.jpg")
            .attr("x", bottomSevenScale(7) + 5)
            .attr("y", bottomTop + pedScale(tenCounts[6]) + 10)
            .attr("width", 40)
            .attr("height", 30);
            svg.append("text")
            .attr("x", bottomSevenScale(7) + 9)
            .attr("y", bottomTop + pedScale(tenCounts[6]) - 10)
            .attr("font-family", "Arial")
            .attr("font-size", 18)
            .attr("fill", "white")
            .text(tenCounts[6]);

            // 8th place
            svg.append("rect")
            .attr("y", bottomTop)
            .attr("x", bottomSevenScale(8))
            .attr("height", pedScale(tenCounts[7]))
            .attr("width", 49)
            .style("fill", "#8C7853");
            svg.append("image")
            .attr("xlink:href", "img/flag8.png")
            .attr("x", bottomSevenScale(8) + 5)
            .attr("y", bottomTop + pedScale(tenCounts[7]) + 10)
            .attr("width", 40)
            .attr("height", 30);
            svg.append("text")
            .attr("x", bottomSevenScale(8) + 9)
            .attr("y", bottomTop + pedScale(tenCounts[7]) - 10)
            .attr("font-family", "Arial")
            .attr("font-size", 18)
            .attr("fill", "white")
            .text(tenCounts[7]);

            // 9th place
            svg.append("rect")
            .attr("y", bottomTop)
            .attr("x", bottomSevenScale(9))
            .attr("height", pedScale(tenCounts[8]))
            .attr("width", 49)
            .style("fill", "8C7853");
            svg.append("image")
            .attr("xlink:href", "img/flag9.png")
            .attr("x", bottomSevenScale(9) + 5)
            .attr("y", bottomTop + pedScale(tenCounts[8]) + 10)
            .attr("width", 40)
            .attr("height", 30);
            svg.append("text")
            .attr("x", bottomSevenScale(9) + 9)
            .attr("y", bottomTop + pedScale(tenCounts[8]) - 10)
            .attr("font-family", "Arial")
            .attr("font-size", 18)
            .attr("fill", "white")
            .text(tenCounts[8]);

            // 10th place
            svg.append("rect")
            .attr("y", bottomTop)
            .attr("x", bottomSevenScale(10))
            .attr("height", pedScale(tenCounts[9]))
            .attr("width", 49)
            .style("fill", "#8C7853");
            svg.append("image")
            .attr("xlink:href", "img/flag10.png")
            .attr("x", bottomSevenScale(10) + 5)
            .attr("y", bottomTop + pedScale(tenCounts[9]) + 10)
            .attr("width", 40)
            .attr("height", 30);
            svg.append("text")
            .attr("x", bottomSevenScale(10) + 9)
            .attr("y", bottomTop + pedScale(tenCounts[9]) - 10)
            .attr("font-family", "Arial")
            .attr("font-size", 18)
            .attr("fill", "white")
            .text(tenCounts[9]);
        }); // end of callback

    </script>

    <script>
        d3.csv("nationLatitudeData.csv", function(latData){
            d3.csv("winterMedalData.csv", function(winterData){
                d3.csv("summerMedalData.csv", function(summerData){
                    var p = d3.select("p");
                    var svg = d3.select('body')
                    .append('svg')
                    .attr('width', 1000)
                    .attr('height', 650);
                    svg.append("text")
                    .text("Distance From Equator In Degrees Latitude")
                    .attr("text-anchor", "middle")
                    .attr("alignment-baseline", "central")
                    .attr("x", -250).attr("y", 10)
                    .attr("transform", "rotate(-90)");
                    svg.append("text")
                    .text("Ratio of Winter to Summer Medals Compared to Latitude")
                    .attr("text-anchor", "middle")
                    .attr("alignment-baseline", "central")
                    .attr("x", 500)
                    .attr("y", 20)
                    .attr("font-size", "36px");
                    svg.append("text")
                    .text("For Top 10 Medal Winning Nations")
                    .attr("text-anchor", "middle")
                    .attr("alignment-baseline", "central")
                    .attr("x", 500)
                    .attr("y", 60)
                    .attr("font-size", "36px");
                    svg.append("text")
                    .text("(Number of Medals Was Normalized By The Number of Events in Winter vs. Summer Games)")
                    .attr("text-anchor", "middle")
                    .attr("alignment-baseline", "central")
                    .attr("x", 500)
                    .attr("y", 88)
                    .attr("font-size", "12px");
                    svg.append("text")
                    .text("Nation (Ordered by Longitude)")
                    .attr("text-anchor", "middle")
                    .attr("alignment-baseline", "central")
                    .attr("x", 500)
                    .attr("y", 600);
                    var svg = svg.append("g").attr("transform", "translate(50,50)");
                    var linearScaleX = d3.scaleLinear().domain([0,10]).range([0,900]);
                    var linearScaleY = d3.scaleLinear().domain([20,70]).range([500,0]);
                    var xAxis = d3.axisBottom(linearScaleX);
                    var yAxis = d3.axisLeft(linearScaleY);
                    var nations = ["", "Canada", "United States", "United Kingdom", "France", "Germany", "Italy", "Russia", "China", "South Korea", "Australia"];
                    svg.append("g")
                    .call(xAxis)
                    .attr("transform", "translate(0,500)")
                    .selectAll("text")
            .text(function(d, i) { return nations[i] }); //Changes the x axis ticks to nations
            svg.append("g")
            .call(yAxis)
            .attr("transform", "translate(0,0)");
        var radius = 35; //radius of the pie charts are hard coded to a size that fits the visualization
        //Winter data for each nation is stored as a variable
        for (var d in winterData){
            if (winterData[d].country == "United States"){
                var USwinter = winterData[d]["count(*)"];
            }
            if (winterData[d].country == "Germany"){
                var GERwinter = winterData[d]["count(*)"];
            }
            if (winterData[d].country == "Russia"){
                var RUSwinter = winterData[d]["count(*)"];
            }
            if (winterData[d].country == "China"){
                var CHIwinter = winterData[d]["count(*)"];
            }
            if (winterData[d].country == "France"){
                var FRAwinter = winterData[d]["count(*)"];
            }
            if (winterData[d].country == "Italy"){
                var ITAwinter = winterData[d]["count(*)"];
            }
            if (winterData[d].country == "Australia"){
                var AUSwinter = winterData[d]["count(*)"];
            }
            if (winterData[d].country == "Korea, South"){
                var KORwinter = winterData[d]["count(*)"];
            }
            if (winterData[d].country == "United Kingdom"){
                var UKwinter = winterData[d]["count(*)"];
            }
            if (winterData[d].country == "Canada"){
                var CANwinter = winterData[d]["count(*)"];
            }
        }
        //Summer data for each nation is stored as a variable
        for (var d in summerData){
            if (summerData[d].country == "United States"){
                var USsummer = summerData[d]["count(*)"];
            }
            if (summerData[d].country == "Germany"){
                var GERsummer = summerData[d]["count(*)"];
            }
            if (summerData[d].country == "Russia"){
                var RUSsummer = summerData[d]["count(*)"];
            }
            if (summerData[d].country == "China"){
                var CHIsummer = summerData[d]["count(*)"];
            }
            if (summerData[d].country == "France"){
                var FRAsummer = summerData[d]["count(*)"];
            }
            if (summerData[d].country == "Italy"){
                var ITAsummer = summerData[d]["count(*)"];
            }
            if (summerData[d].country == "Australia"){
                var AUSsummer = summerData[d]["count(*)"];
            }
            if (summerData[d].country == "Korea, South"){
                var KORsummer = summerData[d]["count(*)"];
            }
            if (summerData[d].country == "United Kingdom"){
                var UKsummer = summerData[d]["count(*)"];
            }
            if (summerData[d].country == "Canada"){
                var CANsummer = summerData[d]["count(*)"];
            }
        }
        //Latitude data for each nation is stored as a variable
        for (var d in latData){
            if (latData[d].country == "United States"){
                var USlat = latData[d]["Latitude"];
            }
            if (latData[d].country == "Germany"){
                var GERlat = latData[d]["Latitude"];
            }
            if (latData[d].country == "Russia"){
                var RUSlat = latData[d]["Latitude"];
            }
            if (latData[d].country == "China"){
                var CHIlat = latData[d]["Latitude"];
            }
            if (latData[d].country == "France"){
                var FRAlat = latData[d]["Latitude"];
            }
            if (latData[d].country == "Italy"){
                var ITAlat = latData[d]["Latitude"];
            }
            if (latData[d].country == "Australia"){
                var AUSlat = latData[d]["Latitude"];
            }
            if (latData[d].country == "Korea, South"){
                var KORlat = latData[d]["Latitude"];
            }
            if (latData[d].country == "United Kingdom"){
                var UKlat = latData[d]["Latitude"];
            }
            if (latData[d].country == "Canada"){
                var CANlat = latData[d]["Latitude"];
            }
        }

        //Calculates the mean latitude for winning a summer medal
        var meanSummerLat = (parseInt(USsummer)*parseInt(USlat) + parseInt(GERsummer)*parseInt(GERlat) + parseInt(RUSsummer)*parseInt(RUSlat) + parseInt(CHIsummer)*parseInt(CHIlat) + parseInt(FRAsummer)*parseInt(FRAlat) + parseInt(ITAsummer)*parseInt(ITAlat) +parseInt(AUSsummer)*parseInt(AUSlat) + parseInt(KORsummer)*parseInt(KORlat) + parseInt(UKsummer)*parseInt(UKlat) + parseInt(CANsummer)*parseInt(CANlat)) / (parseInt(USsummer) + parseInt(GERsummer) + parseInt(RUSsummer) + parseInt(CHIsummer) + parseInt(FRAsummer) + parseInt(ITAsummer) + parseInt(AUSsummer) + parseInt(KORsummer) + parseInt(UKsummer) + parseInt(CANsummer));
        svg.append("line")
        .attr("stroke", 'rgba(255, 180, 66, 1)')
        .attr("x1",linearScaleX(0))
        .attr("x2",linearScaleX(10))
        .attr("y1",linearScaleY(meanSummerLat))
        .attr("y2",linearScaleY(meanSummerLat));
        svg.append("text")
        .text("Mean Latitude For Summer Medal Win")
        .attr("font-size", "12px")
        .attr("text-anchor", "middle")
        .attr("alignment-baseline", "central")
        .attr("x",linearScaleX(9)-10)
        .attr("y",linearScaleY(meanSummerLat)-8);

        //Calculates the mean latitude for winning a winter medal
        var meanWinterLat = (parseInt(USwinter)*parseInt(USlat) + parseInt(GERwinter)*parseInt(GERlat) + parseInt(RUSwinter)*parseInt(RUSlat) + parseInt(CHIwinter)*parseInt(CHIlat) + parseInt(FRAwinter)*parseInt(FRAlat) + parseInt(ITAwinter)*parseInt(ITAlat) +parseInt(AUSwinter)*parseInt(AUSlat) + parseInt(KORwinter)*parseInt(KORlat) + parseInt(UKwinter)*parseInt(UKlat) + parseInt(CANwinter)*parseInt(CANlat)) / (parseInt(USwinter) + parseInt(GERwinter) + parseInt(RUSwinter) + parseInt(CHIwinter) + parseInt(FRAwinter) + parseInt(ITAwinter) + parseInt(AUSwinter) + parseInt(KORwinter) + parseInt(UKwinter) + parseInt(CANwinter));
        svg.append("line")
        .attr("stroke", "rgba(103, 200, 239, 0.9)")
        .attr("x1",linearScaleX(0))
        .attr("x2",linearScaleX(10))
        .attr("y1",linearScaleY(meanWinterLat))
        .attr("y2",linearScaleY(meanWinterLat));
        svg.append("text")
        .text("Mean Latitude For Winter Medal Win")
        .attr("font-size", "12px")
        .attr("text-anchor", "middle")
        .attr("alignment-baseline", "central")
        .attr("x",linearScaleX(9)-10)
        .attr("y",linearScaleY(meanWinterLat)-8);

        //Creates the color scale for the pie charts so that each pie chart has the same
        //color scheme
        var color = d3.scaleOrdinal()
        .range(['rgba(103, 200, 239, 0.9)', 'rgba(255, 180, 66, 1)']);

        //Plots the pie chart for the United States
        var dataset = [{"label": "winter", "value": USwinter},
        {"label": "summer", "value": parseInt(USsummer)/3}];
        svg.append("line")
        .attr("stroke", "gray")
        .attr("x1",linearScaleX(2))
        .attr("x2",linearScaleX(2))
        .attr("y1",linearScaleY(parseInt(USlat)))
        .attr("y2",linearScaleY(20))
        .attr("stroke-dasharray", "5, 5");
        var arc = d3.arc()
        .innerRadius(0)
        .outerRadius(radius);
        var pie = d3.pie()
        .value(function(d) { return d.value; })
            .sort(null); //defines the pie function that is used to create each pie chart
            var g = svg.append('g')
            .attr('transform', 'translate(' + linearScaleX(2) +',' + linearScaleY(parseInt(USlat)) +')');
            var path = g.selectAll('path')
            .data(pie(dataset))
            .enter()
            .append('path')
            .attr('d', arc)
            .attr('fill', function(d, i) {
                return color(d.data.label);
            });

        //Plots the pie chart for Germany
        var dataset = [{"label": "winter", "value": GERwinter},
        {"label": "summer", "value": parseInt(GERsummer)/3}];
        svg.append("line")
        .attr("stroke", "gray")
        .attr("x1",linearScaleX(5))
        .attr("x2",linearScaleX(5))
        .attr("y1",linearScaleY(parseInt(GERlat)))
        .attr("y2",linearScaleY(20))
        .attr("stroke-dasharray", "5, 5");
        var arc = d3.arc()
        .innerRadius(0)
        .outerRadius(radius);
        var g = svg.append('g')
        .attr('transform', 'translate(' + linearScaleX(5) +',' + linearScaleY(parseInt(GERlat)) +')');
        var path = g.selectAll('path')
        .data(pie(dataset))
        .enter()
        .append('path')
        .attr('d', arc)
        .attr('fill', function(d, i) {
            return color(d.data.label);
        });

        //Plots the pie chart for Russia
        var dataset = [{"label": "winter", "value": RUSwinter},
        {"label": "summer", "value": parseInt(RUSsummer)/3}];
        svg.append("line")
        .attr("stroke", "gray")
        .attr("x1",linearScaleX(7))
        .attr("x2",linearScaleX(7))
        .attr("y1",linearScaleY(parseInt(RUSlat)))
        .attr("y2",linearScaleY(20))
        .attr("stroke-dasharray", "5, 5");
        var arc = d3.arc()
        .innerRadius(0)
        .outerRadius(radius);
        var g = svg.append('g')
        .attr('transform', 'translate(' + linearScaleX(7) +',' + linearScaleY(parseInt(RUSlat)) +')');
        var path = g.selectAll('path')
        .data(pie(dataset))
        .enter()
        .append('path')
        .attr('d', arc)
        .attr('fill', function(d, i) {
            return color(d.data.label);
        });

        //Plots the pie chart for China
        var dataset = [{"label": "winter", "value": CHIwinter},
        {"label": "summer", "value": parseInt(CHIsummer)/3}];
        svg.append("line")
        .attr("stroke", "gray")
        .attr("x1",linearScaleX(8))
        .attr("x2",linearScaleX(8))
        .attr("y1",linearScaleY(parseInt(CHIlat)))
        .attr("y2",linearScaleY(20))
        .attr("stroke-dasharray", "5, 5");
        var arc = d3.arc()
        .innerRadius(0)
        .outerRadius(radius);
        var g = svg.append('g')
        .attr('transform', 'translate(' + linearScaleX(8) +',' + linearScaleY(parseInt(CHIlat)) +')');
        var path = g.selectAll('path')
        .data(pie(dataset))
        .enter()
        .append('path')
        .attr('d', arc)
        .attr('fill', function(d, i) {
            return color(d.data.label);
        });

        //Plots the pie chart for France
        var dataset = [{"label": "winter", "value": FRAwinter},
        {"label": "summer", "value": parseInt(FRAsummer)/3}];
        svg.append("line")
        .attr("stroke", "gray")
        .attr("x1",linearScaleX(4))
        .attr("x2",linearScaleX(4))
        .attr("y1",linearScaleY(parseInt(FRAlat)))
        .attr("y2",linearScaleY(20))
        .attr("stroke-dasharray", "5, 5");
        var arc = d3.arc()
        .innerRadius(0)
        .outerRadius(radius);
        var g = svg.append('g')
        .attr('transform', 'translate(' + linearScaleX(4) +',' + linearScaleY(parseInt(FRAlat)) +')');
        var path = g.selectAll('path')
        .data(pie(dataset))
        .enter()
        .append('path')
        .attr('d', arc)
        .attr('fill', function(d, i) {
            return color(d.data.label);
        });

        //Plots the pie chart for Italy
        var dataset = [{"label": "winter", "value": ITAwinter},
        {"label": "summer", "value": parseInt(ITAsummer)/3}];
        svg.append("line")
        .attr("stroke", "gray")
        .attr("x1",linearScaleX(6))
        .attr("x2",linearScaleX(6))
        .attr("y1",linearScaleY(parseInt(ITAlat)))
        .attr("y2",linearScaleY(20))
        .attr("stroke-dasharray", "5, 5");
        var arc = d3.arc()
        .innerRadius(0)
        .outerRadius(radius);
        var g = svg.append('g')
        .attr('transform', 'translate(' + linearScaleX(6) +',' + linearScaleY(parseInt(ITAlat)) +')');
        var path = g.selectAll('path')
        .data(pie(dataset))
        .enter()
        .append('path')
        .attr('d', arc)
        .attr('fill', function(d, i) {
            return color(d.data.label);
        });

        //Plots the pie chart for Australia
        var dataset = [{"label": "winter", "value": AUSwinter},
        {"label": "summer", "value": parseInt(AUSsummer)/3}];
        svg.append("line")
        .attr("stroke", "gray")
        .attr("x1",linearScaleX(10))
        .attr("x2",linearScaleX(10))
        .attr("y1",linearScaleY(parseInt(AUSlat)))
        .attr("y2",linearScaleY(20))
        .attr("stroke-dasharray", "5, 5");
        var arc = d3.arc()
        .innerRadius(0)
        .outerRadius(radius);
        var g = svg.append('g')
        .attr('transform', 'translate(' + linearScaleX(10) +',' + linearScaleY(parseInt(AUSlat)) +')');
        var path = g.selectAll('path')
        .data(pie(dataset))
        .enter()
        .append('path')
        .attr('d', arc)
        .attr('fill', function(d, i) {
            return color(d.data.label);
        });

        //Plots the pie chart for South Korea
        var dataset = [{"label": "winter", "value": KORwinter},
        {"label": "summer", "value": parseInt(KORsummer)/3}];
        svg.append("line")
        .attr("stroke", "gray")
        .attr("x1",linearScaleX(9))
        .attr("x2",linearScaleX(9))
        .attr("y1",linearScaleY(parseInt(KORlat)))
        .attr("y2",linearScaleY(20))
        .attr("stroke-dasharray", "5, 5");
        var arc = d3.arc()
        .innerRadius(0)
        .outerRadius(radius);
        var g = svg.append('g')
        .attr('transform', 'translate(' + linearScaleX(9) +',' + linearScaleY(parseInt(KORlat)) +')');
        var path = g.selectAll('path')
        .data(pie(dataset))
        .enter()
        .append('path')
        .attr('d', arc)
        .attr('fill', function(d, i) {
            return color(d.data.label);
        });

        //Plots the pie chart for the United Kingdom
        var dataset = [{"label": "winter", "value": UKwinter},
        {"label": "summer", "value": parseInt(UKsummer)/3}];
        svg.append("line")
        .attr("stroke", "gray")
        .attr("x1",linearScaleX(3))
        .attr("x2",linearScaleX(3))
        .attr("y1",linearScaleY(parseInt(UKlat)))
        .attr("y2",linearScaleY(20))
        .attr("stroke-dasharray", "5, 5");
        var arc = d3.arc()
        .innerRadius(0)
        .outerRadius(radius);
        var g = svg.append('g')
        .attr('transform', 'translate(' + linearScaleX(3) +',' + linearScaleY(parseInt(UKlat)) +')');
        var path = g.selectAll('path')
        .data(pie(dataset))
        .enter()
        .append('path')
        .attr('d', arc)
        .attr('fill', function(d, i) {
            return color(d.data.label);
        });

        //Plots the pie chart for Canada
        var dataset = [{"label": "winter", "value": CANwinter},
        {"label": "summer", "value": parseInt(CANsummer)/3}];
        svg.append("line")
        .attr("stroke", "gray")
        .attr("x1",linearScaleX(1))
        .attr("x2",linearScaleX(1))
        .attr("y1",linearScaleY(parseInt(CANlat)))
        .attr("y2",linearScaleY(20))
        .attr("stroke-dasharray", "5, 5");
        var arc = d3.arc()
        .innerRadius(0)
        .outerRadius(radius);
        var g = svg.append('g')
        .attr('transform', 'translate(' + linearScaleX(1) +',' + linearScaleY(parseInt(CANlat)) +')');
        var path = g.selectAll('path')
        .data(pie(dataset))
        .enter()
        .append('path')
        .attr('d', arc)
        .attr('fill', function(d, i) {
            return color(d.data.label);
        });

        //the block of code below is to build the key for the visulization
        svg.append("rect")
        .attr("stroke", "black")
        .attr("fill", "white")
        .attr("x", linearScaleX(8))
        .attr("y", linearScaleY(65))
        .attr("width", linearScaleX(2))
        .attr("height", 80);
        svg.append("text")
        .text("Key").attr("text-anchor", "middle")
        .attr("alignment-baseline", "central")
        .attr("x", linearScaleX(9))
        .attr("y", linearScaleY(65)+10);
        svg.append("rect")
        .attr("fill", "rgba(103, 200, 239, 0.9)")
        .attr("x", linearScaleX(8)+15)
        .attr("y", linearScaleY(65)+27)
        .attr("width", 15).attr("height", 15);
        svg.append("text")
        .text("Winter Medals")
        .attr("text-anchor", "middle")
        .attr("alignment-baseline", "central")
        .attr("x", linearScaleX(9)+8)
        .attr("y", linearScaleY(65)+35);
        svg.append("rect")
        .attr("fill", "rgba(255, 180, 66, 1)")
        .attr("x", linearScaleX(8)+15)
        .attr("y", linearScaleY(65)+57)
        .attr("width", 15).attr("height", 15);
        svg.append("text")
        .text("Summer Medals")
        .attr("text-anchor", "middle")
        .attr("alignment-baseline", "central")
        .attr("x", linearScaleX(9)+12)
        .attr("y", linearScaleY(65)+65);
        GDPVis();
    });
});
});

</script>

<script id="GDPvMedals">
    GDPVis = function () {
        var height2 = 600;
        var width2  = 1000;

        var svgS = d3.select("body").append("svg")
        .attr("height", height2)
        .attr("width", width2);

        var svgW = d3.select("body").append("svg")
        .attr("height", height2)
        .attr("width", width2);

        d3.queue()
        .defer(d3.csv, "winterGDPMedalData.csv")
        .defer(d3.csv, "summerGDPMedalData.csv")
        .await(showGraph);

        function showGraph(error, wData, sData) {

            wData.sort(function(a, b){ return b.Medals - a.Medals});
            sData.sort(function(a, b){ return b.Medals - a.Medals});

            var xMax = d3.max(
                [
                d3.max(wData, function (d) {
                    return +d.GDP_per_Capita;
                }),
                d3.max(sData, function (d) {
                    return +d.GDP_per_Capita;
                })
                ]);

            svgS.append("text")
            .attr("x", 500)
            .attr("y", 50)
            .style("text-anchor", "middle")
            .text("Summer Medals Earned VS GDP Per Capita")
            .style("font-size", "36px");

            svgS.append("text")
            .attr("x", 500)
            .attr("y", height2-50)
            .style("text-anchor", "middle")
            .text("GDP Per Capita");

            svgS.append("text")
            .attr("x", 50)
            .attr("y", height2/2)
            .style("text-anchor", "middle")
            .text("Medals Earned (1986-2014)")
            .attr("transform", "translate(-250,350)rotate(-90)");

            var yMaxS = d3.max(sData, function (d) {return +d.Medals});

            var xScale = d3.scaleLinear()
            .domain([0,xMax])
            .range([100,width2-100]);

            var yScaleS = d3.scaleLinear()
            .domain([0, yMaxS])
            .range([height2-100,100]);

            var xAxis = d3.axisBottom(xScale);
            var yAxis = d3.axisLeft(yScaleS);

            svgS.append("g").call(xAxis).attr("transform","translate(0,500)");
            svgS.append("g").call(yAxis).attr("transform","translate(100,0)");

            sData.forEach(function (d, i) {
                if(i<10) { //Top 10 Medal earning countries
                    if (d.Country == "China") {
                        svgS.append("line")
                        .attr("x1", xScale(+d.GDP_per_Capita) + 20)
                        .attr("x2", xScale(+d.GDP_per_Capita) + 30)
                        .attr("y1", yScaleS(+d.Medals))
                        .attr("y2", yScaleS(+d.Medals) - 3)
                        .style("stroke", "black")
                        .style("stroke-width", "1");

                        svgS.append("text")
                        .text("China")
                        .attr("x", xScale(+d.GDP_per_Capita) + 30)
                        .attr("y", yScaleS(+d.Medals) - 3)
                        .style("fill", "black")
                        .style("font-size", "12px");
                    }
                    svgS.append("image")
                    .attr("x", xScale(+d.GDP_per_Capita))
                    .attr("y", yScaleS(+d.Medals))
                    .attr("xlink:href", "img/ByName/" + d.Country + ".png")
                    .attr("width", 30);
                }
                else {
                    svgS.append("circle")
                    .attr("r", 2)
                    .attr("cx", xScale(+d.GDP_per_Capita))
                    .attr("cy", yScaleS(+d.Medals))
                    .style("fill","black");
                }
            });

            svgW.append("text")
            .attr("x", 500)
            .attr("y", 50)
            .style("text-anchor", "middle")
            .text("Winter Medals Earned VS GDP Per Capita")
            .style("font-size", "36px");

            svgW.append("text")
            .attr("x", 500)
            .attr("y", height2-50)
            .style("text-anchor", "middle")
            .text("GDP Per Capita");

            svgW.append("text")
            .attr("x", 50)
            .attr("y", height2/2)
            .style("text-anchor", "middle")
            .text("Medals Earned (1986-2014)")
            .attr("transform", "translate(-250,350)rotate(-90)");


            var yMaxW = d3.max(wData, function (d) {return +d.Medals});


            var yScaleW = d3.scaleLinear()
            .domain([0, yMaxW])
            .range([height2-100,100]);

            var yAxisW = d3.axisLeft(yScaleW);


            svgW.append("g").call(xAxis).attr("transform","translate(0,500)");
            svgW.append("g").call(yAxisW).attr("transform","translate(100,0)");

            wData.forEach(function (d, i) {
                if(i<10) { //Top 10 Medal earning countries
                    // Overlapped by Canada...
                    if (d.Country == "Austria") {

                        svgW.append("line")
                        .attr("x1", xScale(+d.GDP_per_Capita) + 20)
                        .attr("x2", xScale(+d.GDP_per_Capita) + 30)
                        .attr("y1", yScaleW(+d.Medals))
                        .attr("y2", yScaleW(+d.Medals) - 3)
                        .style("stroke", "black")
                        .style("stroke-width", "1");

                        svgW.append("text")
                        .text("Austria")
                        .attr("x", xScale(+d.GDP_per_Capita) + 30)
                        .attr("y", yScaleW(+d.Medals) - 3)
                        .style("fill", "black")
                        .style("font-size", "12px");
                    }
                    svgW.append("image")
                    .attr("x", xScale(+d.GDP_per_Capita))
                    .attr("y", yScaleW(+d.Medals))
                    .attr("xlink:href", "img/ByName/" + d.Country + ".png")
                    .attr("width", 30);


                }
                else {
                    svgW.append("circle")
                    .attr("r", 2)
                    .attr("cx", xScale(+d.GDP_per_Capita))
                    .attr("cy", yScaleW(+d.Medals))
                    .style("fill","black");
                }
            })
        }
    }
</script>


</script>


</body>



</html>
